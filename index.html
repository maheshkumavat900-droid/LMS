<!doctype html><html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Smart LMS â€” Sign In</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"><link href="style.css" rel="stylesheet"></head>
<body class="d-flex align-items-center justify-content-center" style="min-height:100vh;">
<div class="container" style="max-width: 640px;">
  <div class="card p-4">
    <div class="d-flex justify-content-between align-items-center mb-2"><h3 class="m-0">ðŸ“š Smart LMS</h3><button class="btn btn-outline-secondary" onclick="toggleTheme()">ðŸŒ“</button></div>
    <p class="small-muted">Sign in or create an account</p>
    <ul class="nav nav-pills mb-3"><li class="nav-item"><button class="nav-link active" data-bs-toggle="pill" data-bs-target="#signin">Sign In</button></li><li class="nav-item"><button class="nav-link" data-bs-toggle="pill" data-bs-target="#signup">Sign Up</button></li></ul>
    <div class="tab-content">
      <div class="tab-pane fade show active" id="signin">
        <form class="vstack gap-3" onsubmit="return login(event)">
          <div><label class="form-label">Email</label><input type="email" id="email" class="form-control" placeholder="user@lms.local" required></div>
          <div><label class="form-label">Password</label><input type="password" id="password" class="form-control" required></div>
          <div><label class="form-label">Role</label><select id="role" class="form-select" onchange="toggleEnrollSignIn()"><option value="STUDENT">Student</option><option value="ADMIN">Admin</option></select></div>
          <div id="signinEnroll" class="small-muted">Student selected â€” enrollment will be required at issue time.</div>
          <button class="btn btn-primary btn-lg w-100 neon">Sign In</button>
        </form>
      </div>
      <div class="tab-pane fade" id="signup">
        <form class="vstack gap-3" onsubmit="return signup(event)">
          <div class="row g-3">
            <div class="col-12"><label class="form-label">Full Name</label><input id="s_name" class="form-control" required></div>
            <div class="col-12"><label class="form-label">Email</label><input id="s_email" type="email" class="form-control" required></div>
            <div class="col-12"><label class="form-label">Password</label><input id="s_pass" type="password" class="form-control" required></div>
            <div class="col-12"><label class="form-label">Role</label><select id="s_role" class="form-select" onchange="toggleEnroll()"><option value="STUDENT">Student</option><option value="ADMIN">Admin</option></select></div>
            <div class="col-12" id="enrollWrap"><label class="form-label">Enrollment No</label><input id="s_enroll" class="form-control" placeholder="e.g., 22BCA1007" required></div>
          </div>
          <button class="btn btn-primary btn-lg w-100 neon">Create Account</button>
        </form>
      </div>
    </div>
    <div id="msg" class="mt-3"></div>
  </div><footer class="text-center mt-3">Modern UI â€¢ Bootstrap 5 â€¢ Final Pro Build</footer>
</div>
<script src="shared.js"></script>
<script>
initTheme(); seedBooksIfEmpty(); (function autoBackup(){ try{ const payload = { users:getUsers(), books:books(), issues:issues(), requests:requests(), exportedAt:new Date().toISOString() }; localStorage.setItem('lms_backup_auto', JSON.stringify(payload)); }catch(e){} })();
function toggleEnroll(){ const r=s_role.value; const wrap=document.getElementById('enrollWrap'); const input=document.getElementById('s_enroll'); if(r==='STUDENT'){ wrap.style.display='block'; input.required=true; } else { wrap.style.display='none'; input.required=false; } }
function toggleEnrollSignIn(){ const r=role.value; const hint=document.getElementById('signinEnroll'); hint.innerHTML = (r==='ADMIN') ? 'Admin selected â€” no enrollment required.' : 'Student selected â€” enrollment will be required at issue time.'; }
function login(e){ e.preventDefault(); const users = getUsers(); const email=document.getElementById('email').value.trim(); const pass=document.getElementById('password').value; const r=document.getElementById('role').value; const u = users.find(u=>u.email===email && u.pass===pass && u.role===r); if(!u){ return setMsg('danger','Invalid credentials'); } setSession(u); seedBooksIfEmpty(); window.location.href = r==='ADMIN' ? 'admin.html' : 'dashboard.html'; return false; }
function signup(e){ e.preventDefault(); const users=getUsers(); const email=s_email.value.trim(); if(users.find(u=>u.email===email)){ return setMsg('danger','User already exists'); } const r=s_role.value; const u={ name:s_name.value.trim(), email, pass:s_pass.value, role:r, enroll: r==='STUDENT' ? s_enroll.value.trim() : '' }; if(r==='STUDENT' && !u.enroll){ return setMsg('danger','Enrollment is required'); } users.push(u); setUsers(users); setMsg('success','Registration successful! Please sign in.'); document.querySelector('[data-bs-target="#signin"]').click(); return false; }
function setMsg(type,text){ msg.innerHTML = `<div class="alert alert-${type}">${text}</div>`; }
(function seed(){ const users=getUsers(); if(!users.find(u=>u.email==='admin@lms.local')){ users.push({name:'Admin', email:'admin@lms.local', pass:'admin123', role:'ADMIN'}); } if(!users.find(u=>u.email==='mahesh@student.local')){ users.push({name:'Mahesh Kumavat', email:'mahesh@student.local', pass:'mahesh123', role:'STUDENT', enroll:'22BCA1007'}); } setUsers(users); toggleEnroll(); toggleEnrollSignIn(); })();
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body></html>